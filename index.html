<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LikeInk Designer - Custom Tattoo Sheet Designer</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>LikeInk Designer</h1>
            <p>Design your custom A5 tattoo sheet</p>
        </header>

        <div class="designer-workspace">
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="toolbar-group">
                    <button id="open-upload-dialog-btn" class="btn btn-primary">
                        ‚ûï Add Content
                    </button>
                    <label for="file-upload" class="btn btn-primary">
                        üìÅ Upload Image
                    </label>
                    <input type="file" id="file-upload" accept="image/*" multiple style="display: none;">
                </div>

                <div class="toolbar-group">
                    <button id="select-all-btn" class="btn btn-secondary">
                        ‚òëÔ∏è Select All
                    </button>
                    <button id="deselect-btn" class="btn btn-secondary" disabled>
                        ‚òê Deselect
                    </button>
                    <button id="duplicate-btn" class="btn btn-secondary" disabled>
                        üìã Duplicate
                    </button>
                    <button id="delete-btn" class="btn btn-danger" disabled>
                        üóëÔ∏è Delete
                    </button>
                </div>

                <div class="toolbar-group">
                    <button id="undo-btn" class="btn btn-secondary" disabled>
                        ‚Ü©Ô∏è Undo
                    </button>
                    <button id="redo-btn" class="btn btn-secondary" disabled>
                        ‚Ü™Ô∏è Redo
                    </button>
                </div>

                <div class="toolbar-group">
                    <button id="bring-forward-btn" class="btn btn-secondary" disabled>
                        ‚¨ÜÔ∏è Forward
                    </button>
                    <button id="send-backward-btn" class="btn btn-secondary" disabled>
                        ‚¨áÔ∏è Backward
                    </button>
                </div>

                <div class="toolbar-group">
                    <button id="clear-btn" class="btn btn-warning">
                        üîÑ Clear All
                    </button>
                    <button id="fill-sheet-btn" class="btn btn-secondary">
                        ‚ú® Auto Fill Sheet
                    </button>
                </div>

                <div class="toolbar-group">
                    <button id="add-to-cart-btn" class="btn btn-primary">
                        üõí Add to Cart
                    </button>
                </div>
            </div>

            <!-- Canvas Container -->
            <div class="canvas-container">
                <div class="canvas-wrapper">
                    <div class="ruler-top" id="ruler-top"></div>
                    <div class="ruler-left" id="ruler-left"></div>
                    <div class="canvas-area">
                        <canvas id="designer-canvas"></canvas>
                    </div>
                </div>
                <div class="canvas-info">
                    <p>üìè A5 Landscape (210mm √ó 148mm) ‚Ä¢ 300 DPI</p>
                    <p class="bleed-info">Red dashed line shows 5mm bleed area - keep important elements inside</p>
                </div>
            </div>

            <!-- Instructions -->
            <div class="instructions">
                <h3>How to use:</h3>
                <ul>
                    <li><strong>Upload:</strong> Click "Upload Image" or drag & drop images onto the canvas</li>
                    <li><strong>Move:</strong> Drag images around the canvas</li>
                    <li><strong>Resize:</strong> Drag corner handles to resize (hold Shift for proportional)</li>
                    <li><strong>Rotate:</strong> Drag the rotation handle at the top</li>
                    <li><strong>Select All:</strong> Press Ctrl+A to select all images</li>
                    <li><strong>Deselect:</strong> Press ESC to deselect all images</li>
                    <li><strong>Duplicate:</strong> Select an image and click "Duplicate" or press Ctrl+D</li>
                    <li><strong>Delete:</strong> Select an image and click "Delete" or press Delete key</li>
                    <li><strong>Undo/Redo:</strong> Use Ctrl+Z to undo, Ctrl+Y to redo</li>
                    <li><strong>Fill Sheet:</strong> Automatically arranges images and fills the entire sheet with
                        copies (3mm spacing)</li>
                    <li><strong>Bleed Area:</strong> Keep important parts inside the red dashed line</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Upload Dialog -->
    <div id="upload-dialog" class="upload-dialog">
        <div class="upload-dialog-content">
            <div class="dialog-header">
                <h2 id="dialog-title">Add Content to Sheet</h2>
                <button id="close-dialog-btn" class="close-dialog-btn" title="Close">‚úï</button>
            </div>

            <!-- Content Type Selector -->
            <div class="content-type-selector">
                <button id="image-mode-btn" class="content-type-btn active">üìÅ Image</button>
                <button id="text-mode-btn" class="content-type-btn">üìù Text</button>
                <button id="symbol-mode-btn" class="content-type-btn">üîç Symbols</button>
            </div>

            <!-- Image Upload Section -->
            <div id="image-section" class="content-section active">
                <!-- Upload Zone -->
                <div id="upload-zone" class="upload-zone">
                    <div class="upload-zone-content">
                        <div class="upload-icon">üìÅ</div>
                        <p class="upload-text">Click to upload or drag & drop an image</p>
                        <p class="upload-hint">Supports PNG, JPG, SVG</p>
                        <input type="file" id="dialog-file-upload" accept="image/*" style="display: none;">
                    </div>
                </div>

                <!-- Preview Section (hidden by default) -->
                <div id="preview-section" class="preview-section" style="display: none;">
                    <div class="preview-container">
                        <img id="preview-image" src="" alt="Preview">
                    </div>

                    <div class="size-control">
                        <label for="size-slider">Size on skin: <span id="size-value">10</span> cm √ó <span
                                id="size-height-value">‚Äî</span> cm</label>
                        <input type="range" id="size-slider" min="10" max="210" value="100" step="10">
                    </div>

                    <div class="dialog-question">
                        <p>Do you want to add more content to the sheet?</p>
                        <div class="dialog-buttons">
                            <button id="add-more-btn" class="btn btn-primary">Yes, let me add more content</button>
                            <button id="fill-sheet-dialog-btn" class="btn btn-secondary">No, show me the sheet</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Text Input Section (hidden by default) -->
            <div id="text-section" class="content-section">
                <div class="text-preview-control">
                    <label for="text-preview">Enter your text:</label>
                    <div id="text-preview" class="text-preview" contenteditable="true" role="textbox"
                        aria-multiline="true" data-placeholder="Type your text to preview the font."></div>
                </div>

                <div class="text-size-control">
                    <label for="text-size-slider">Size on skin: <span id="text-size-value">‚Äî</span> cm √ó <span
                            id="text-height-value">‚Äî</span> cm</label>
                    <input type="range" id="text-size-slider" min="20" max="200" value="40" step="5">
                </div>

                <div id="text-size-warning" class="text-size-warning" style="display: none;">
                    <p>‚ö†Ô∏è Text is too wide! It exceeds the printable area and will be cut off.</p>
                </div>

                <div class="text-font-control">
                    <label for="text-font-select">Choose a font:</label>
                    <select id="text-font-select">
                        <option value="Arial" selected>Arial</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Comic Sans MS">Comic Sans MS</option>
                        <option value="Impact">Impact</option>
                    </select>
                </div>

                <div class="dialog-question">
                    <p>Do you want to add more content to the sheet?</p>
                    <div class="dialog-buttons">
                        <button id="add-text-btn" class="btn btn-primary">Yes, let me add more content</button>
                        <button id="fill-sheet-text-btn" class="btn btn-secondary">No, show me the sheet</button>
                    </div>
                </div>
            </div>

            <!-- Symbols Section (hidden by default) -->
            <div id="symbols-section" class="content-section">
                <div id="symbol-domain-warning" class="symbol-info-banner" style="display: none;">
                    <p>Set <code>window.svgApiDomainKey</code> before opening the dialog to enable searching the SVG
                        API.</p>
                </div>
                
                <div id="symbol-selection-panel" class="symbol-selection-panel" style="display: none;">
                    <div id="symbol-preview" class="symbol-preview"></div>
                    <div class="symbol-selection-details">
                        <h4 id="symbol-title">Symbol preview</h4>
                        <p id="symbol-tags" class="symbol-tags"></p>
                    </div>
                    <div class="dialog-buttons">
                        <button id="add-symbol-btn" class="btn btn-primary">Add symbol to sheet</button>
                        <button id="fill-sheet-symbol-btn" class="btn btn-secondary">Add & auto fill sheet</button>
                    </div>
                </div>

                <div class="symbol-search-bar">
                    <input type="search" id="symbol-search-input"
                        placeholder="Search symbols (e.g. 'flower', 'moon', 'triangle')" autocomplete="off">
                    <button id="symbol-search-btn" class="btn btn-primary">Search</button>
                </div>
                <p class="symbol-search-hint">Press Enter or click Search to load symbols.</p>

                <div id="symbol-loading" class="symbol-loading" role="status" aria-live="polite" style="display: none;">
                    <span>Searching thousands of icons‚Ä¶</span>
                </div>

                <div id="symbol-results-container" class="symbol-results-container">
                    <div id="symbol-empty-state" class="symbol-empty-state">
                        <p>Use the search box to explore thousands of SVG symbols.</p>
                    </div>
                    <div id="symbol-results-grid" class="symbol-results-grid"></div>
                </div>

                <div id="symbol-pagination" class="symbol-pagination" style="display: none;">
                    <button id="symbol-prev-btn" class="btn btn-secondary" disabled>‚óÄ Previous</button>
                    <span id="symbol-page-info" class="symbol-page-info">Page 1</span>
                    <button id="symbol-next-btn" class="btn btn-secondary" disabled>Next ‚ñ∂</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Load Fabric.js from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/fabric@latest/dist/index.min.js"></script>
    <script src="js/designer.js"></script>
</body>

</html>